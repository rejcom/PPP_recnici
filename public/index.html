<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PPP - ZÃ¡pis a diktovÃ¡nÃ­</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“ PsychologickÃ¡ poradna - ZÃ¡pis rozhovoru</h1>
            <div class="user-info">
                <a href="dashboard.html" class="btn btn-primary" style="margin-right:10px; text-decoration:none; font-size:13px; padding:6px 14px;">ğŸ“Š Dashboard klientÅ¯</a>
                <span id="userEmail">Demo reÅ¾im</span>
            </div>
        </header>

        <main>
            <!-- OvlÃ¡dacÃ­ panel -->
            <section class="controls">
                <div class="control-group">
                    <h2>NahrÃ¡vÃ¡nÃ­ a pÅ™epis</h2>
                    <div class="buttons">
                        <button id="startRealtime" class="btn btn-primary">
                            ğŸ¤ Spustit real-time pÅ™epis
                        </button>
                        <button id="stopRealtime" class="btn btn-danger" disabled>
                            â¹ï¸ Zastavit
                        </button>
                        <button id="uploadAudio" class="btn btn-secondary">
                            ğŸ“ NahrÃ¡t audio soubor
                        </button>
                    </div>
                    <input type="file" id="audioFile" accept="audio/*" style="display:none;">

                    <div class="recording-info">
                        <span id="recordingTime">00:00</span>
                        <span id="status" class="status-indicator">PÅ™ipraveno</span>
                    </div>
                </div>

                <!-- Informace o klientovi -->
                <div class="control-group">
                    <h3>Informace o klientovi</h3>
                    <div class="client-info">
                        <input type="text" id="clientName" placeholder="JmÃ©no klienta (nepovinnÃ©)">
                        <input type="date" id="sessionDate" value="">
                        <select id="sessionType">
                            <option value="prvni">PrvnÃ­ schÅ¯zka</option>
                            <option value="nasledna">NÃ¡slednÃ¡ schÅ¯zka</option>
                            <option value="kontrola">KontrolnÃ­ schÅ¯zka</option>
                        </select>
                    </div>
                </div>
            </section>

            <!-- PÅ™epis -->
            <section class="transcript-section">
                <div class="section-header">
                    <h2>PÅ™epis rozhovoru</h2>
                    <div class="buttons">
                        <button id="loadDemo" class="btn btn-small btn-secondary">ğŸ“‹ NaÄÃ­st demo data</button>
                        <button id="clearTranscript" class="btn btn-small">Vymazat</button>
                    </div>
                </div>

                <!-- ManuÃ¡lnÃ­ pÅ™epÃ­nÃ¡nÃ­ Å™eÄnÃ­kÅ¯ (zobrazÃ­ se pÅ™i nahrÃ¡vÃ¡nÃ­) -->
                <div id="manualSpeakerControls" class="manual-speaker-controls" style="display: none;">
                    <div class="speaker-controls-header">
                        <span>ğŸ™ï¸ AktuÃ¡lnÃ­ Å™eÄnÃ­k:</span>
                        <span id="activeSpeakerDisplay" class="active-speaker-display">Å˜eÄnÃ­k 1</span>
                    </div>
                    <div class="speaker-controls-buttons">
                        <button id="switchSpeaker" class="btn btn-small btn-primary" title="KlÃ¡vesa: Tab">
                            ğŸ”„ PÅ™epnout Å™eÄnÃ­ka (Tab)
                        </button>
                        <button id="addSpeaker" class="btn btn-small btn-secondary">
                            â• PÅ™idat Å™eÄnÃ­ka
                        </button>
                    </div>
                    <div id="speakerQuickButtons" class="speaker-quick-buttons"></div>
                </div>

                <!-- Panel Å™eÄnÃ­kÅ¯ (role) -->
                <div id="speakerPanel" class="speaker-panel" style="display: none;">
                    <h3>ğŸ‘¥ Å˜eÄnÃ­ci</h3>
                    <p class="speaker-hint">PÅ™iÅ™aÄte role jednotlivÃ½m Å™eÄnÃ­kÅ¯m pro lepÅ¡Ã­ orientaci v pÅ™episu:</p>
                    <div id="speakerList" class="speaker-list"></div>
                </div>

                <div id="transcript" class="transcript-box" contenteditable="true">
                    Zde se zobrazÃ­ pÅ™epis rozhovoru...
                </div>
            </section>

            <!-- StrukturovanÃ½ zÃ¡pis -->
            <section class="report-section">
                <div class="section-header">
                    <h2>StrukturovanÃ½ zÃ¡pis</h2>
                    <button id="generateReport" class="btn btn-primary">ğŸ¤– Generovat zÃ¡pis z pÅ™episu</button>
                </div>

                <div class="report-form">
                    <div class="form-group">
                        <label>1. DÅ¯vod nÃ¡vÅ¡tÄ›vy / AnamnÃ©za</label>
                        <textarea id="anamneza" rows="4" placeholder="ProÄ klient pÅ™iÅ¡el, co ho trÃ¡pÃ­..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>2. PozorovÃ¡nÃ­ bÄ›hem schÅ¯zky</label>
                        <textarea id="pozorovani" rows="4" placeholder="ChovÃ¡nÃ­ klienta, emotivnÃ­ stav, komunikace..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>3. ProvedenÃ¡ vyÅ¡etÅ™enÃ­ / Metody</label>
                        <textarea id="metody" rows="3" placeholder="JakÃ© testy, dotaznÃ­ky nebo metody byly pouÅ¾ity..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>4. ZjiÅ¡tÄ›nÃ­ a zÃ¡vÄ›ry</label>
                        <textarea id="zavery" rows="4" placeholder="Co bylo zjiÅ¡tÄ›no, diagnostickÃ© zÃ¡vÄ›ry..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>5. DoporuÄenÃ­ a dalÅ¡Ã­ postup</label>
                        <textarea id="doporuceni" rows="4" placeholder="DoporuÄenÃ¡ opatÅ™enÃ­, dalÅ¡Ã­ schÅ¯zky, doporuÄenÃ­ pro rodiÄe/Å¡kolu..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>6. PoznÃ¡mky psychologa</label>
                        <textarea id="poznamky" rows="3" placeholder="InternÃ­ poznÃ¡mky, pro dalÅ¡Ã­ sezenÃ­..."></textarea>
                    </div>
                </div>
            </section>

            <!-- Export -->
            <section class="export-section">
                <h2>Export</h2>
                <div class="buttons">
                    <button id="exportWord" class="btn btn-success">ğŸ“„ Exportovat do Word</button>
                    <button id="exportPDF" class="btn btn-success">ğŸ“‘ Exportovat do PDF</button>
                    <button id="saveLocal" class="btn btn-secondary">ğŸ’¾ UloÅ¾it lokÃ¡lnÄ›</button>
                </div>
            </section>
        </main>

        <footer>
            <div class="info-box">
                <h3>â„¹ï¸ Demo verze s AI</h3>
                <p><strong>ğŸ¤ PÅ™epis:</strong> Azure Speech-to-Text (5 hodin/mÄ›sÃ­c zdarma, pak ~1 USD/hod)</p>
                <p><strong>ğŸ¤– AI ZÃ¡pis:</strong> Mistral AI Large (~0.002 USD na zÃ¡pis, â‚¬2/$2 free credit)</p>
                <p><strong>ğŸ’° Odhad nÃ¡kladÅ¯:</strong> 30 sezenÃ­/mÄ›sÃ­c = cca 500-600 KÄ celkem</p>
            </div>
        </footer>
    </div>

    <!-- Azure Speech SDK - LokÃ¡lnÃ­ kopie -->
    <script src="speech-sdk.js"></script>

    <!-- Fallback CDN pokud lokÃ¡lnÃ­ kopie nefunguje -->
    <script>
        if (typeof SpeechSDK === 'undefined') {
            console.warn('LokÃ¡lnÃ­ SDK nenalezeno, naÄÃ­tÃ¡m z CDN...');
            var script = document.createElement('script');
            script.src = 'https://aka.ms/csspeech/jsbrowserpackage';
            script.async = false;
            document.head.appendChild(script);
        }
    </script>

    <!-- NaÅ¡e aplikace -->
    <script src="app.js"></script>
</body>
</html>
