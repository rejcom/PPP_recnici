<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PPP Dashboard - Spr√°va klient≈Ø</title>
    <link rel="stylesheet" href="dashboard.css">
    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Chart.js pro grafy pokroku -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4"></script>
</head>
<body>
    <!-- LOGIN SCREEN -->
    <div id="loginScreen" class="login-screen">
        <div class="login-card">
            <h1>üìù PPP Platform</h1>
            <p>Pedagogicko-psychologick√° poradna</p>

            <div id="loginForm">
                <div class="form-field">
                    <label>E-mail</label>
                    <input type="email" id="loginEmail" placeholder="vas@email.cz" required>
                </div>
                <div class="form-field">
                    <label>Heslo</label>
                    <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                </div>
                <button id="loginBtn" class="btn btn-primary btn-block">P≈ôihl√°sit se</button>
                <button id="showRegisterBtn" class="btn btn-link">Nem√°te √∫ƒçet? Zaregistrujte se</button>
                <div id="loginError" class="error-msg" style="display:none;"></div>
            </div>

            <div id="registerForm" style="display:none;">
                <div class="form-field">
                    <label>Jm√©no</label>
                    <input type="text" id="regFirstName" placeholder="Jan" required>
                </div>
                <div class="form-field">
                    <label>P≈ô√≠jmen√≠</label>
                    <input type="text" id="regLastName" placeholder="Nov√°k" required>
                </div>
                <div class="form-field">
                    <label>E-mail</label>
                    <input type="email" id="regEmail" placeholder="jan.novak@ppp.cz" required>
                </div>
                <div class="form-field">
                    <label>Heslo</label>
                    <input type="password" id="regPassword" placeholder="Min. 6 znak≈Ø" required>
                </div>
                <div class="form-field">
                    <label>Role</label>
                    <select id="regRole">
                        <option value="psycholog">Psycholog</option>
                        <option value="etoped">Etoped</option>
                        <option value="logoped">Logoped</option>
                        <option value="specialni_pedagog">Speci√°ln√≠ pedagog</option>
                        <option value="socialn√≠_pracovnik">Soci√°ln√≠ pracovn√≠k</option>
                    </select>
                </div>
                <div class="form-field">
                    <label>N√°zev instituce</label>
                    <input type="text" id="regInstitution" placeholder="PPP Praha 1">
                </div>
                <button id="registerBtn" class="btn btn-primary btn-block">Zaregistrovat se</button>
                <button id="showLoginBtn" class="btn btn-link">Ji≈æ m√°te √∫ƒçet? P≈ôihlaste se</button>
                <div id="registerError" class="error-msg" style="display:none;"></div>
            </div>

            <div class="login-footer">
                <a href="index.html">‚Üê Zpƒõt na p≈ôepis bez p≈ôihl√°≈°en√≠</a>
            </div>
        </div>
    </div>

    <!-- MAIN DASHBOARD -->
    <div id="dashboard" class="dashboard" style="display:none;">
        <!-- Top nav -->
        <nav class="top-nav">
            <div class="nav-brand">
                <span class="nav-logo">üìù</span>
                <span class="nav-title">PPP Platform</span>
            </div>
            <div class="nav-tabs">
                <button class="nav-tab active" data-tab="overview">üìä P≈ôehled</button>
                <button class="nav-tab" data-tab="clients">üë• Klienti</button>
                <button class="nav-tab" data-tab="newSession">üé§ Nov√© sezen√≠</button>
                <button class="nav-tab" data-tab="documents">üìÅ Dokumenty</button>
            </div>
            <div class="nav-user">
                <span id="navUserName">Psycholog</span>
                <button id="logoutBtn" class="btn btn-small btn-danger">Odhl√°sit</button>
            </div>
        </nav>

        <!-- TAB: P≈ôehled -->
        <div id="tab-overview" class="tab-content active">
            <div class="page-header">
                <h2>P≈ôehled</h2>
                <span id="institutionName" class="institution-badge"></span>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="statClients">0</div>
                    <div class="stat-label">Aktivn√≠ klienti</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="statSessions">0</div>
                    <div class="stat-label">Celkem sezen√≠</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="statDocuments">0</div>
                    <div class="stat-label">Dokumenty</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="statThisMonth">0</div>
                    <div class="stat-label">Tento mƒõs√≠c</div>
                </div>
            </div>

            <div class="section-card">
                <h3>Posledn√≠ sezen√≠</h3>
                <div id="recentSessionsList" class="list-container">
                    <p class="empty-state">Naƒç√≠t√°m...</p>
                </div>
            </div>
        </div>

        <!-- TAB: Klienti -->
        <div id="tab-clients" class="tab-content">
            <div class="page-header">
                <h2>Klienti</h2>
                <div class="header-actions">
                    <input type="text" id="clientSearch" placeholder="üîç Hledat klienta..." class="search-input">
                    <button id="addClientBtn" class="btn btn-primary">‚ûï Nov√Ω klient</button>
                </div>
            </div>

            <div id="clientsList" class="cards-grid">
                <p class="empty-state">Naƒç√≠t√°m klienty...</p>
            </div>

            <!-- Client Detail Modal -->
            <div id="clientDetailModal" class="modal" style="display:none;">
                <div class="modal-content modal-large">
                    <div class="modal-header">
                        <h3 id="clientDetailName">Detail klienta</h3>
                        <button class="modal-close" onclick="closeModal('clientDetailModal')">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="detail-tabs">
                            <button class="detail-tab active" data-detail="info">üìã Info</button>
                            <button class="detail-tab" data-detail="sessions">üìù Sezen√≠</button>
                            <button class="detail-tab" data-detail="progress">üìà Pokrok</button>
                            <button class="detail-tab" data-detail="docs">üìÅ Dokumenty</button>
                        </div>

                        <!-- Info -->
                        <div id="detail-info" class="detail-content active">
                            <div id="clientInfoContent"></div>
                        </div>

                        <!-- Sezen√≠ -->
                        <div id="detail-sessions" class="detail-content">
                            <div id="clientSessionsList"></div>
                        </div>

                        <!-- Pokrok -->
                        <div id="detail-progress" class="detail-content">
                            <div class="progress-controls">
                                <select id="progressCategory">
                                    <option value="">V≈°echny kategorie</option>
                                    <option value="chovani">Chov√°n√≠</option>
                                    <option value="soustredeni">Soust≈ôedƒõn√≠</option>
                                    <option value="matematika">Matematika</option>
                                    <option value="cteni">ƒåten√≠</option>
                                    <option value="psani">Psan√≠</option>
                                    <option value="komunikace">Komunikace</option>
                                    <option value="socialni_dovednosti">Soci√°ln√≠ dovednosti</option>
                                    <option value="emoce">Emoce</option>
                                    <option value="motorika">Motorika</option>
                                </select>
                            </div>
                            <canvas id="progressChart" width="600" height="300"></canvas>
                            <div id="progressTimeline"></div>
                        </div>

                        <!-- Dokumenty -->
                        <div id="detail-docs" class="detail-content">
                            <div class="docs-actions">
                                <button class="btn btn-primary btn-small" onclick="uploadDocument()">üì§ Nahr√°t dokument</button>
                                <input type="file" id="docUploadInput" accept=".doc,.docx,.pdf" style="display:none;">
                            </div>
                            <div id="clientDocsList"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- New Client Modal -->
            <div id="newClientModal" class="modal" style="display:none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Nov√Ω klient</h3>
                        <button class="modal-close" onclick="closeModal('newClientModal')">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-field">
                            <label>Jm√©no *</label>
                            <input type="text" id="newClientFirstName" required>
                        </div>
                        <div class="form-field">
                            <label>P≈ô√≠jmen√≠ *</label>
                            <input type="text" id="newClientLastName" required>
                        </div>
                        <div class="form-field">
                            <label>Datum narozen√≠</label>
                            <input type="date" id="newClientBirthDate">
                        </div>
                        <div class="form-field">
                            <label>Pohlav√≠</label>
                            <select id="newClientGender">
                                <option value="">--</option>
                                <option value="M">Chlapec</option>
                                <option value="F">D√≠vka</option>
                            </select>
                        </div>
                        <div class="form-field">
                            <label>≈†kola</label>
                            <input type="text" id="newClientSchool" placeholder="Z≈† P≈ô√≠kladn√≠">
                        </div>
                        <div class="form-field">
                            <label>T≈ô√≠da</label>
                            <input type="text" id="newClientClass" placeholder="3.A">
                        </div>
                        <div class="form-field">
                            <label>Jm√©no rodiƒçe</label>
                            <input type="text" id="newClientParent">
                        </div>
                        <div class="form-field">
                            <label>Telefon rodiƒçe</label>
                            <input type="tel" id="newClientParentPhone">
                        </div>
                        <div class="form-field">
                            <label>E-mail rodiƒçe</label>
                            <input type="email" id="newClientParentEmail">
                        </div>
                        <div class="form-field">
                            <label>Pozn√°mky</label>
                            <textarea id="newClientNotes" rows="3"></textarea>
                        </div>
                        <button id="saveNewClientBtn" class="btn btn-primary btn-block">Ulo≈æit klienta</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB: Nov√© sezen√≠ -->
        <div id="tab-newSession" class="tab-content">
            <div class="page-header">
                <h2>üé§ Nov√© sezen√≠</h2>
            </div>
            <div class="session-setup">
                <div class="form-field">
                    <label>Klient *</label>
                    <select id="sessionClientSelect">
                        <option value="">-- Vyberte klienta --</option>
                    </select>
                </div>
                <div class="form-field">
                    <label>Typ sezen√≠</label>
                    <select id="sessionTypeSelect">
                        <option value="prvni">Prvn√≠ sch≈Øzka</option>
                        <option value="nasledna" selected>N√°sledn√° sch≈Øzka</option>
                        <option value="kontrola">Kontroln√≠ sch≈Øzka</option>
                        <option value="diagnostika">Diagnostika</option>
                        <option value="intervence">Intervence</option>
                    </select>
                </div>
                <a href="index.html" class="btn btn-primary" target="_blank">
                    üé§ Otev≈ô√≠t p≈ôepis rozhovoru ‚Üí
                </a>
                <p class="hint-text">
                    Po dokonƒçen√≠ p≈ôepisu se vra≈•te sem, vlo≈æte p≈ôepis a ulo≈æte sezen√≠ do datab√°ze.
                </p>
            </div>

            <div class="section-card">
                <h3>P≈ôepis rozhovoru</h3>
                <textarea id="sessionTranscript" rows="8" placeholder="Vlo≈æte p≈ôepis rozhovoru z p≈ôepisovac√≠ str√°nky (Ctrl+A ‚Üí Ctrl+C ‚Üí Ctrl+V)..."></textarea>
            </div>

            <div class="section-card">
                <h3>Strukturovan√Ω z√°pis</h3>
                <button id="generateFromTranscript" class="btn btn-primary">ü§ñ Generovat AI z√°pis</button>

                <div class="report-grid">
                    <div class="form-field">
                        <label>1. Anamn√©za</label>
                        <textarea id="sessAnamneza" rows="4"></textarea>
                    </div>
                    <div class="form-field">
                        <label>2. Pozorov√°n√≠</label>
                        <textarea id="sessPozorovani" rows="4"></textarea>
                    </div>
                    <div class="form-field">
                        <label>3. Metody</label>
                        <textarea id="sessMetody" rows="3"></textarea>
                    </div>
                    <div class="form-field">
                        <label>4. Z√°vƒõry</label>
                        <textarea id="sessZavery" rows="4"></textarea>
                    </div>
                    <div class="form-field">
                        <label>5. Doporuƒçen√≠</label>
                        <textarea id="sessDoporuceni" rows="4"></textarea>
                    </div>
                    <div class="form-field">
                        <label>6. Pozn√°mky</label>
                        <textarea id="sessPoznamky" rows="3"></textarea>
                    </div>
                </div>
            </div>

            <div class="section-card">
                <h3>üìà Hodnocen√≠ pokroku</h3>
                <p class="hint-text">Ohodno≈•te stav klienta v kategori√≠ch (1 = velmi ≈°patn√©, 5 = v√Ωborn√©):</p>
                <div id="progressRatings" class="ratings-grid"></div>
            </div>

            <div class="session-actions">
                <button id="saveSessionBtn" class="btn btn-success btn-large">üíæ Ulo≈æit sezen√≠ do datab√°ze</button>
                <button id="saveAndExportBtn" class="btn btn-primary btn-large">üìÑ Ulo≈æit + Exportovat Word</button>
            </div>
        </div>

        <!-- TAB: Dokumenty -->
        <div id="tab-documents" class="tab-content">
            <div class="page-header">
                <h2>üìÅ Dokumenty</h2>
                <div class="header-actions">
                    <select id="docFilterClient">
                        <option value="">V≈°ichni klienti</option>
                    </select>
                    <button class="btn btn-primary" onclick="uploadDocument()">üì§ Nahr√°t dokument</button>
                </div>
            </div>
            <div id="allDocsList" class="list-container">
                <p class="empty-state">Naƒç√≠t√°m dokumenty...</p>
            </div>
        </div>
    </div>

    <script src="dashboard.js"></script>
</body>
</html>
